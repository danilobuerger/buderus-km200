package api

import "crypto/md5"

var salt = []byte{
	0x86, 0x78, 0x45, 0xe9, 0x7c, 0x4e, 0x29, 0xdc,
	0xe5, 0x22, 0xb9, 0xa7, 0xd3, 0xa3, 0xe0, 0x7b,
	0x15, 0x2b, 0xff, 0xad, 0xdd, 0xbe, 0xd7, 0xf5,
	0xff, 0xd8, 0x42, 0xe9, 0x89, 0x5a, 0xd1, 0xe4,
}

func newKey(gatewayPassword, privatePassword string) []byte {
	key1 := md5.New()
	key1.Write([]byte(gatewayPassword))
	key1.Write(salt)

	key2 := md5.New()
	key2.Write(salt)
	key2.Write([]byte(privatePassword))

	return append(key1.Sum(nil), key2.Sum(nil)...)
}
